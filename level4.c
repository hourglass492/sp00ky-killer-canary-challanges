#include <signal.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#define debug 0
#include <time.h>


char name[100];

unsigned int contestent_num;
unsigned int safe_birdy;

struct data {
    char yourinput[10];
    unsigned int birdy;
    int give_flag;
};

time_t start;

//for i in {0..10000}; do   python3 -c 'import sys; import struct; val = struct.pack("I", 0x6551677d); rVal = struct.pack("I", 0x555553c6); rVal2 = struct.pack("I", 0x00005555); sys.stdout.buffer.write(b"A" * 12 + val + b"A" * 24 + rVal + rVal2)' | ./level4 | tee -a debug ; sleep 1; done
// char flag[] = "s00ky_ctf{7h3_l0N3_5UrvIv3R_W3ll_d0N3}";

char flag[] = 
    {0x3a,0x71,0x63,0x2c,0x79,0x16,0x22,0x27,0x21,0x7b,0x7e,0x29,
    0x60,0x18,0x6c,0x79,0xf,0x60,0x18,0x35,0x1c,0x33,0x25,0xe,0x76,
    0x7a,0x13,0xc,0x10,0x33,0x25,0x2d,0xc,0x23,0x30,0x7,0x72,0x2e,0x47,0x0};

char key[] = {1,5,2,3,0};

char main_string[] = {0x3f,0x2e,0x3a,0x23,0x20,0x3d,0x33,0x2a,0x18,0x74,0x26,0x1e,0x36,0x34,0x63,0x28,0x31,0x36,0x6f,0x29,0x32,0x4b,0x73,0x67,0x20,0x69,0x32,0x21,0x26,0x6e,0x2d,0x69,0x27,0x2e,0x6d,0x2c,0x69,0x63,0x6e,0x29,0x72,0x4b,0x73,0x67,0x20,0x69,0x32,0x27,0x35,0x75,0x2a,0x35,0x73,0x23,0x61,0x3d,0x20,0x73,0x23,0x61,0x3d,0x20,0x73,0x7a,0x20,0x32,0x4b,0x73,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x67,0x38,0x3c,0x32,0x72,0x20,0x2f,0x23,0x32,0x74,0x69,0x7c,0x73,0x3c,0x20,0x79,0x61,0x2e,0x6b,0xa,0x69,0x61,0x73,0x67,0x20,0x69,0x61,0x73,0x69,0x62,0x20,0x33,0x37,0x3e,0x20,0x74,0x61,0x34,0x22,0x74,0x16,0x23,0x3a,0x35,0x64,0x30,0x69,0x21,0x26,0x6e,0x2d,0x69,0x7a,0x67,0x25,0x69,0x70,0x63,0x77,0x29,0x65,0x4b,0x73,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x67,0x26,0x3a,0x31,0x65,0x16,0x27,0x3f,0x26,0x67,0x69,0x7c,0x73,0x77,0x2c,0x43,0x61,0x73,0x67,0x20,0x34,0x7a,0x59,0x4d,0x20,0x69,0x61,0x73,0x34,0x61,0x2f,0x24,0xc,0x25,0x69,0x3b,0x25,0x2a,0x67,0x3d,0x69,0x25,0x32,0x33,0x61,0x67,0x23,0x3a,0x35,0x64,0x30,0x7a,0x59,0x67,0x20,0x69,0x61,0x23,0x35,0x69,0x27,0x35,0x35,0x6f,0x22,0x1e,0x24,0x3f,0x24,0x6f,0x24,0x24,0x73,0x31,0x69,0x2a,0x35,0x3a,0x2a,0x20,0x6c,0x25,0xf,0x29,0x20,0x1e,0x29,0x32,0x33,0x20,0x28,0x33,0x36,0x67,0x79,0x26,0x34,0x21,0x67,0x6c,0x28,0x32,0x27,0x67,0x77,0x26,0x33,0x37,0x34,0x3a,0x6b,0x6d,0x73,0x24,0x6f,0x27,0x35,0x36,0x34,0x74,0x2c,0x2f,0x27,0x18,0x6e,0x3c,0x2c,0x7a,0x7c,0xa,0x69,0x61,0x73,0x67,0x67,0x2c,0x35,0x20,0x6f,0x28,0x2a,0x29,0x32,0x35,0x2a,0x60,0x61,0x75,0x23,0x61,0x3d,0x20,0x7d,0x3e,0x6f,0x3c,0x33,0x3a,0x29,0x70,0x3c,0x35,0x7a,0x7c,0xa,0x43,0x4b,0x73,0x67,0x20,0x69,0x31,0x26,0x33,0x73,0x61,0x63,0xf,0x29,0x47,0x26,0x2e,0x37,0x67,0x62,0x30,0x24,0x73,0x7d,0x29,0x15,0x2f,0x71,0x6e,0x3b,0x43,0x4b,0x73,0x67,0x20,0x69,0x28,0x35,0x67,0x28,0x2d,0x20,0x27,0x26,0x2e,0x2b,0x28,0x21,0x23,0x79,0x69,0x60,0x6e,0x67,0x73,0x28,0x27,0x36,0x18,0x62,0x20,0x33,0x37,0x3e,0x29,0x69,0x3a,0x59,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x69,0x31,0x21,0x2e,0x6e,0x3d,0x27,0x7b,0x65,0x59,0x26,0x34,0x73,0x2c,0x69,0x25,0x2d,0x36,0x23,0x20,0x24,0x38,0x73,0x25,0x69,0x3b,0x25,0x2a,0x6b,0x20,0x3a,0x20,0x37,0x67,0x64,0x2c,0x20,0x37,0x67,0x62,0x20,0x33,0x37,0x3e,0x20,0x73,0x69,0x73,0x1b,0x6e,0x69,0x9,0x3a,0x34,0x20,0x27,0x20,0x3e,0x22,0x20,0x3e,0x20,0x20,0x67,0x30,0x31,0x64,0x2b,0x67,0x62,0x3c,0x35,0x73,0x3e,0x6f,0x3c,0x61,0x38,0x2e,0x6c,0x25,0x24,0x37,0x67,0x68,0x20,0x2c,0x73,0x26,0x6e,0x2d,0x61,0x3d,0x28,0x77,0x69,0x28,0x27,0x60,0x73,0x69,0x71,0x2b,0x62,0x78,0x15,0x2f,0x71,0x6b,0x20,0x3a,0x20,0x35,0x22,0x5f,0x2b,0x28,0x21,0x23,0x79,0x65,0x61,0x37,0x26,0x74,0x28,0x6f,0x31,0x2e,0x72,0x2d,0x38,0x7a,0x7c,0xa,0x69,0x61,0x73,0x67,0x20,0x69,0x61,0x73,0x2e,0x66,0x69,0x69,0x72,0x67,0x64,0x2c,0x23,0x26,0x20,0x29,0x69,0x24,0x2b,0x2e,0x74,0x61,0x70,0x7a,0x7c,0xa,0x69,0x61,0x73,0x67,0x7d,0x43,0x4b,0x73,0x67,0x20,0x69,0x28,0x35,0x67,0x28,0x2d,0x20,0x27,0x26,0x2e,0x2e,0x28,0x25,0x22,0x5f,0x2f,0x2d,0x32,0x20,0x29,0x69,0x3a,0x59,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x69,0x31,0x26,0x33,0x73,0x61,0x63,0xf,0x29,0x4d,0x30,0x61,0x31,0x2e,0x72,0x2d,0x61,0x20,0x33,0x69,0x25,0x2d,0x73,0x2b,0x69,0x3f,0x24,0x20,0x67,0x3a,0x60,0x61,0x20,0x28,0x20,0x0,0x61,0x34,0x32,0x65,0x3a,0x32,0x73,0xe,0x27,0x25,0x2d,0x73,0x20,0x69,0x3f,0x24,0x73,0x3e,0x6f,0x3c,0x61,0x3c,0x29,0x65,0x69,0x2c,0x3c,0x35,0x65,0x69,0x22,0x3b,0x26,0x6e,0x2a,0x24,0xf,0x29,0x22,0x60,0x7a,0x59,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x69,0x31,0x21,0x2e,0x6e,0x3d,0x27,0x7b,0x65,0x54,0x26,0x61,0x36,0x34,0x63,0x28,0x31,0x36,0x67,0x79,0x26,0x34,0x73,0x2a,0x75,0x3a,0x35,0x73,0x20,0x6f,0x3d,0x2e,0x73,0x62,0x70,0x6b,0x6d,0x73,0x21,0x6c,0x28,0x26,0x34,0x2e,0x66,0x30,0x68,0x68,0x4d,0x20,0x69,0x61,0x73,0x67,0x20,0x69,0x61,0x23,0x35,0x69,0x27,0x35,0x35,0x6f,0x22,0x7,0x2e,0x24,0x67,0x77,0x2c,0x61,0x32,0x35,0x65,0x69,0x26,0x3c,0x2e,0x6e,0x2e,0x61,0x27,0x28,0x20,0x6c,0x31,0xf,0x29,0x20,0x3e,0x28,0x3f,0x2b,0x20,0x30,0x2e,0x26,0x67,0x73,0x3c,0x33,0x25,0x2e,0x76,0x2c,0x7e,0x71,0x6b,0x20,0x69,0x1e,0xc,0x25,0x75,0x20,0x2d,0x27,0x2e,0x6e,0x16,0x33,0x36,0x33,0x75,0x3b,0x2f,0xc,0x26,0x64,0x2d,0x33,0x36,0x34,0x73,0x61,0x71,0x7a,0x6e,0x3b,0x43,0x61,0x73,0x67,0x20,0x34,0x4b,0x59,0x67,0x20,0x69,0x61,0x59,0x3a,0x3b,0x69,0x41,0x7d};
// {0x3f,0x2e,0x3a,0x23,0x20,0x3d,0x33,0x2a,0x18,0x74,0x26,0x1e,0x36,0x34,0x63,0x28,0x31,0x36,0x6f,0x29,0x32,0x4b,0x73,0x67,0x20,0x69,0x32,0x21,0x26,0x6e,0x2d,0x69,0x27,0x2e,0x6d,0x2c,0x69,0x63,0x6e,0x29,0x72,0x4b,0x73,0x67,0x20,0x69,0x32,0x27,0x35,0x75,0x2a,0x35,0x73,0x23,0x61,0x3d,0x20,0x73,0x23,0x61,0x3d,0x20,0x73,0x7a,0x20,0x32,0x4b,0x73,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x67,0x38,0x3c,0x32,0x72,0x20,0x2f,0x23,0x32,0x74,0x69,0x7c,0x73,0x3c,0x20,0x79,0x61,0x2e,0x6b,0xa,0x69,0x61,0x73,0x67,0x20,0x69,0x61,0x73,0x69,0x62,0x20,0x33,0x37,0x3e,0x20,0x74,0x61,0x34,0x22,0x74,0x16,0x23,0x3a,0x35,0x64,0x30,0x69,0x21,0x26,0x6e,0x2d,0x69,0x7a,0x67,0x25,0x69,0x70,0x63,0x77,0x29,0x65,0x4b,0x73,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x67,0x26,0x3a,0x31,0x65,0x16,0x27,0x3f,0x26,0x67,0x69,0x7c,0x73,0x77,0x2c,0x43,0x61,0x73,0x67,0x20,0x34,0x7a,0x59,0x4d,0x20,0x69,0x61,0x73,0x34,0x61,0x2f,0x24,0xc,0x25,0x69,0x3b,0x25,0x2a,0x67,0x3d,0x69,0x25,0x32,0x33,0x61,0x67,0x23,0x3a,0x35,0x64,0x30,0x7a,0x59,0x67,0x20,0x69,0x61,0x23,0x35,0x69,0x27,0x35,0x35,0x6f,0x22,0x1e,0x24,0x3f,0x24,0x6f,0x24,0x24,0x73,0x31,0x69,0x2a,0x35,0x3a,0x2a,0x20,0x6c,0x25,0xf,0x29,0x20,0x1e,0x29,0x32,0x33,0x20,0x28,0x33,0x36,0x67,0x79,0x26,0x34,0x21,0x67,0x6c,0x28,0x32,0x27,0x67,0x77,0x26,0x33,0x37,0x34,0x3a,0x6b,0x6d,0x73,0x24,0x6f,0x27,0x35,0x36,0x34,0x74,0x2c,0x2f,0x27,0x18,0x6e,0x3c,0x2c,0x7a,0x7c,0xa,0x69,0x61,0x73,0x67,0x67,0x2c,0x35,0x20,0x6f,0x28,0x2a,0x29,0x32,0x35,0x2a,0x60,0x61,0x75,0x23,0x61,0x3d,0x20,0x7d,0x3e,0x6f,0x3c,0x33,0x3a,0x29,0x70,0x3c,0x35,0x7a,0x7c,0xa,0x43,0x4b,0x73,0x67,0x20,0x69,0x31,0x26,0x33,0x73,0x61,0x63,0xf,0x29,0x47,0x26,0x2e,0x37,0x67,0x62,0x30,0x24,0x73,0x7d,0x29,0x15,0x2f,0x71,0x6e,0x3b,0x43,0x4b,0x73,0x67,0x20,0x69,0x28,0x35,0x67,0x28,0x2d,0x20,0x27,0x26,0x2e,0x2b,0x28,0x21,0x23,0x79,0x69,0x60,0x6e,0x67,0x73,0x28,0x27,0x36,0x18,0x62,0x20,0x33,0x37,0x3e,0x29,0x69,0x3a,0x59,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x69,0x31,0x21,0x2e,0x6e,0x3d,0x27,0x7b,0x65,0x59,0x26,0x34,0x73,0x2c,0x69,0x25,0x2d,0x36,0x23,0x20,0x24,0x38,0x73,0x25,0x69,0x3b,0x25,0x2a,0x6b,0x20,0x3a,0x20,0x37,0x67,0x64,0x2c,0x20,0x37,0x67,0x62,0x20,0x33,0x37,0x3e,0x20,0x73,0x69,0x73,0x1b,0x6e,0x69,0x9,0x3a,0x34,0x20,0x27,0x20,0x3e,0x22,0x20,0x3e,0x20,0x20,0x67,0x30,0x31,0x64,0x2b,0x67,0x62,0x3c,0x35,0x73,0x3e,0x6f,0x3c,0x61,0x38,0x2e,0x6c,0x25,0x24,0x37,0x67,0x68,0x20,0x2c,0x73,0x26,0x6e,0x2d,0x61,0x3d,0x28,0x77,0x69,0x28,0x27,0x60,0x73,0x69,0x71,0x2b,0x62,0x78,0x15,0x2f,0x71,0x6b,0x20,0x3a,0x20,0x35,0x22,0x5f,0x2b,0x28,0x21,0x23,0x79,0x65,0x61,0x37,0x26,0x74,0x28,0x6f,0x31,0x2e,0x72,0x2d,0x38,0x7a,0x7c,0xa,0x69,0x61,0x73,0x67,0x20,0x69,0x61,0x73,0x2e,0x66,0x69,0x69,0x72,0x67,0x64,0x2c,0x23,0x26,0x20,0x29,0x69,0x24,0x2b,0x2e,0x74,0x61,0x70,0x7a,0x7c,0xa,0x69,0x61,0x73,0x67,0x7d,0x43,0x4b,0x73,0x67,0x20,0x69,0x28,0x35,0x67,0x28,0x2d,0x20,0x27,0x26,0x2e,0x2e,0x28,0x25,0x22,0x5f,0x2f,0x2d,0x32,0x20,0x20,0x74,0x7c,0x73,0x77,0x78,0xd,0x4,0x12,0x3,0x42,0xc,0x4,0x15,0x6e,0x20,0x32,0x4b,0x73,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x39,0x34,0x27,0x34,0x28,0x6b,0x1d,0x3d,0xa,0x79,0x69,0x23,0x3a,0x35,0x64,0x69,0x32,0x27,0x2e,0x6c,0x25,0x61,0x3f,0x2e,0x76,0x2c,0x32,0x73,0x7d,0x29,0x69,0x32,0x3c,0x67,0x49,0x69,0x26,0x26,0x22,0x73,0x3a,0x61,0x1a,0x60,0x6c,0x25,0x61,0x34,0x2e,0x76,0x2c,0x61,0x2a,0x28,0x75,0x69,0x2e,0x3d,0x22,0x20,0x24,0x2e,0x21,0x22,0x20,0x2a,0x29,0x32,0x29,0x63,0x2c,0x1d,0x3d,0x65,0x29,0x72,0x4b,0x73,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x39,0x33,0x3a,0x29,0x74,0x2f,0x69,0x71,0x13,0x6f,0x69,0x24,0x20,0x24,0x61,0x39,0x24,0x73,0x3e,0x6f,0x3c,0x61,0x3e,0x32,0x73,0x3d,0x61,0x34,0x28,0x74,0x26,0x61,0x76,0x37,0x22,0x65,0x61,0x35,0x2b,0x61,0x2e,0x26,0x3a,0x21,0x79,0x60,0x7a,0x59,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x69,0x31,0x21,0x2e,0x6e,0x3d,0x27,0x7b,0x65,0x4e,0x26,0x36,0x73,0x30,0x65,0x69,0x20,0x21,0x22,0x20,0x2e,0x2e,0x3a,0x29,0x67,0x69,0x35,0x3c,0x67,0x25,0x39,0x1d,0x3d,0x67,0x77,0x20,0x2d,0x3f,0x67,0x79,0x26,0x34,0x73,0x34,0x75,0x3b,0x37,0x3a,0x31,0x65,0x76,0x63,0x7f,0x67,0x20,0x16,0x1e,0x31,0x32,0x69,0x25,0x35,0x3a,0x29,0x5f,0x3b,0x24,0x27,0x32,0x72,0x27,0x1e,0x32,0x23,0x64,0x3b,0x24,0x20,0x34,0x28,0x79,0x68,0x7a,0x7c,0xa,0x69,0x61,0x73,0x67,0x7d,0x43,0x4b,0x73,0x67,0x20,0x69,0x4b,0x2e,0x7c,0x20,0x49,0x41};
//     {0x3f,0x2e,0x3a,0x23,0x20,0x3d,0x33,0x2a,0x18,0x74,0x26,0x1e,
//     0x36,0x34,0x63,0x28,0x31,0x36,0x6f,0x29,0x32,0x4b,0x73,0x67,
//     0x20,0x69,0x32,0x21,0x26,0x6e,0x2d,0x69,0x27,0x2e,0x6d,0x2c
//     ,0x69,0x63,0x6e,0x29,0x72,0x4b,0x73,0x67,0x20,0x69,0x32,0x27,
//     0x35,0x75,0x2a,0x35,0x73,0x23,0x61,0x3d,0x20,0x73,0x23,0x61,
//     0x3d,0x20,0x73,0x7a,0x20,0x32,0x4b,0x73,0x67,0x20,0x69,0x61,
//     0x73,0x67,0x20,0x67,0x38,0x3c,0x32,0x72,0x20,0x2f,0x23,0x32,
//     0x74,0x69,0x7c,0x73,0x3c,0x20,0x79,0x61,0x2e,0x6b,0xa,0x69,
//     0x61,0x73,0x67,0x20,0x69,0x61,0x73,0x69,0x62,0x20,0x33,0x37,
//     0x3e,0x20,0x74,0x61,0x34,0x22,0x74,0x16,0x23,0x3a,0x35,0x64,
//     0x30,0x69,0x21,0x26,0x6e,0x2d,0x69,0x7a,0x67,0x25,0x69,0x70,
//     0x63,0x77,0x29,0x65,0x4b,0x73,0x67,0x20,0x69,0x61,0x73,0x67,
//     0x20,0x67,0x26,0x3a,0x31,0x65,0x16,0x27,0x3f,0x26,0x67,0x69,
//     0x7c,0x73,0x77,0x2c,0x43,0x61,0x73,0x67,0x20,0x34,0x7a,0x59,
//     0x4d,0x20,0x69,0x61,0x73,0x34,0x61,0x2f,0x24,0xc,0x25,0x69,
//     0x3b,0x25,0x2a,0x67,0x3d,0x69,0x25,0x32,0x33,0x61,0x67,0x23,
//     0x3a,0x35,0x64,0x30,0x7a,0x59,0x67,0x20,0x69,0x61,0x23,0x35,
//     0x69,0x27,0x35,0x35,0x6f,0x22,0x1e,0x24,0x3f,0x24,0x6f,0x24,
//     0x24,0x73,0x31,0x69,0x2a,0x35,0x3a,0x2a,0x20,0x6c,0x25,0xf,
//     0x29,0x20,0x1e,0x29,0x32,0x33,0x20,0x28,0x33,0x36,0x67,0x79,
//     0x26,0x34,0x21,0x67,0x6c,0x28,0x32,0x27,0x67,0x77,0x26,0x33,
//     0x37,0x34,0x3a,0x6b,0x6d,0x73,0x24,0x6f,0x27,0x35,0x36,0x34,
//     0x74,0x2c,0x2f,0x27,0x18,0x6e,0x3c,0x2c,0x7a,0x7c,0xa,0x69,
//     0x61,0x73,0x67,0x67,0x2c,0x35,0x20,0x6f,0x28,0x2a,0x29,0x32,
//     0x35,0x2a,0x60,0x61,0x75,0x23,0x61,0x3d,0x20,0x7d,0x3e,0x6f,
//     0x3c,0x33,0x3a,0x29,0x70,0x3c,0x35,0x7a,0x7c,0xa,0x43,0x4b,
//     0x73,0x67,0x20,0x69,0x31,0x26,0x33,0x73,0x61,0x63,0xf,0x29,
//     0x47,0x26,0x2e,0x37,0x67,0x62,0x30,0x24,0x73,0x7d,0x29,0x15,
//     0x2f,0x71,0x6e,0x3b,0x43,0x4b,0x73,0x67,0x20,0x69,0x28,0x35,
//     0x67,0x28,0x2d,0x20,0x27,0x26,0x2e,0x2b,0x28,0x21,0x23,0x79,
//     0x69,0x60,0x6e,0x67,0x73,0x28,0x27,0x36,0x18,0x62,0x20,0x33,
//     0x37,0x3e,0x29,0x69,0x3a,0x59,0x67,0x20,0x69,0x61,0x73,0x67,
//     0x20,0x69,0x31,0x21,0x2e,0x6e,0x3d,0x27,0x7b,0x65,0x59,0x26,
//     0x34,0x73,0x2c,0x69,0x25,0x2d,0x36,0x23,0x20,0x24,0x38,0x73,
//     0x25,0x69,0x3b,0x25,0x2a,0x6b,0x20,0x3a,0x20,0x37,0x67,0x64,
//     0x2c,0x20,0x37,0x67,0x62,0x20,0x33,0x37,0x3e,0x20,0x73,0x69,
//     0x73,0x1b,0x6e,0x69,0x9,0x3a,0x34,0x20,0x27,0x20,0x3e,0x22,
//     0x3e,0x20,0x20,0x67,0x30,0x31,0x64,0x2b,0x67,0x62,0x3c,0x35
//     ,0x73,0x3e,0x6f,0x3c,0x61,0x38,0x2e,0x6c,0x25,0x24,0x37,0x67,
//     0x68,0x20,0x2c,0x73,0x26,0x6e,0x2d,0x61,0x3d,0x28,0x77,0x69,
//     0x28,0x27,0x60,0x73,0x69,0x71,0x2b,0x62,0x78,0x15,0x2f,0x71,
//     0x6b,0x20,0x3a,0x20,0x35,0x22,0x5f,0x2b,0x28,0x21,0x23,0x79,
//     0x65,0x61,0x37,0x26,0x74,0x28,0x6f,0x31,0x2e,0x72,0x2d,0x38,
//     0x7a,0x7c,0xa,0x69,0x61,0x73,0x67,0x20,0x69,0x61,0x73,0x2e,
//     0x66,0x69,0x69,0x72,0x67,0x64,0x2c,0x23,0x26,0x20,0x29,0x69,
//     0x24,0x2b,0x2e,0x74,0x61,0x70,0x7a,0x7c,0xa,0x69,0x61,0x73,
//     0x67,0x7d,0x43,0x4b,0x73,0x67,0x20,0x69,0x28,0x35,0x67,0x28,
//     0x2d,0x20,0x27,0x26,0x2e,0x2e,0x28,0x25,0x22,0x5f,0x2f,0x2d,
//     0x32,0x20,0x20,0x74,0x7c,0x73,0x77,0x78,0xd,0x4,0x12,0x3,0x42,
//     0xc,0x4,0x15,0x6e,0x20,0x32,0x4b,0x73,0x67,0x20,0x69,0x61,0x73,
//     0x67,0x20,0x39,0x34,0x27,0x34,0x28,0x6b,0x1d,0x3d,0xa,0x79,0x69,
//     0x23,0x3a,0x35,0x64,0x69,0x32,0x27,0x2e,0x6c,0x25,0x61,0x3f,0x2e,
//     0x76,0x2c,0x32,0x73,0x7d,0x29,0x69,0x32,0x3c,0x67,0x49,0x69,0x26,
//     0x26,0x22,0x73,0x3a,0x61,0x1a,0x60,0x6c,0x25,0x61,0x34,0x2e,0x76,
//     0x2c,0x61,0x2a,0x28,0x75,0x69,0x2e,0x3d,0x22,0x20,0x24,0x2e,0x21,
//     0x22,0x20,0x2a,0x29,0x32,0x29,0x63,0x2c,0x1d,0x3d,0x65,0x29,0x72,
//     0x4b,0x73,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x39,0x33,0x3a,0x29,
//     0x74,0x2f,0x69,0x71,0x13,0x6f,0x69,0x24,0x20,0x24,0x61,0x39,0x24,
//     0x73,0x3e,0x6f,0x3c,0x61,0x3e,0x32,0x73,0x3d,0x61,0x34,0x28,0x74,
//     0x26,0x61,0x76,0x37,0x22,0x65,0x61,0x35,0x2b,0x61,0x2e,0x26,0x3a,
//     0x21,0x79,0x60,0x7a,0x59,0x67,0x20,0x69,0x61,0x73,0x67,0x20,0x69,
//     0x31,0x21,0x2e,0x6e,0x3d,0x27,0x7b,0x65,0x4e,0x26,0x36,0x73,0x30,
//     0x65,0x69,0x20,0x21,0x22,0x20,0x2e,0x2e,0x3a,0x29,0x67,0x69,0x35,
//     0x3c,0x67,0x25,0x39,0x1d,0x3d,0x67,0x77,0x20,0x2d,0x3f,0x67,0x79,
//     0x26,0x34,0x73,0x34,0x75,0x3b,0x37,0x3a,0x31,0x65,0x76,0x63,0x7f,
//     0x67,0x20,0x16,0x1e,0x31,0x32,0x69,0x25,0x35,0x3a,0x29,0x5f,0x3b,
//     0x24,0x27,0x32,0x72,0x27,0x1e,0x32,0x23,0x64,0x3b,0x24,0x20,0x34,
//     0x28,0x79,0x68,0x7a,0x7c,0xa,0x69,0x61,0x73,0x67,0x7d,0x43,0x4b,
//     0x73,0x67,0x20,0x69,0x4b,0x2e,0x7c,0x20,0x49,0x41};
// char main_string[] = "void try_to_escape(){\n\
//     srand(time(0));\n\
//     struct data data = {\n\
//         .yourinput = { 0 },\n\
//         .birdy = get_birdy(rand() \% 100),\n\
//         .give_flag = 0,\n\
//     };\n\
// \n\
//     safe_birdy = data.birdy;\n\
//     printf(\"Welcome victim \%d\\n What are your last words:\", contestent_num);\n\
//     gets((char*) &data.yourinput);\n\
// \n\
// \n\
//     puts(\"\\nGood bye :)\\n\");\n\
// \n\
//     if (data.birdy != safe_birdy) {\n\
//         printf(\"You killed my birdy, sad dead birdy :( \\n His name was 0x\%x but you killed him and now it\'s 0x\%x\\n\", safe_birdy, data.birdy);\n\
//         if (! debug) exit(1);\n\
//     }\n\
// \n\
//     if (data.give_flag) {\n\
//         puts(\"\\nMy bird still lives :) so I guess I\'ll give you one more chance\\n\");\n\
//         printf(\"To escape you must goto \%p\", flaggify);\n\
//         printf(\"Now we are going to \%p\\n will you survive?\",  __builtin_return_address(0));\n\
//     }\n\
// \n\
//     \n\
// }; ";

// char bird_name_string[] = "get_birdy(int iters){\n    srand(1337);\n\
//     int i = 0;\n\
//     for(i = 0; i < iters; i++) rand();\n\
//     contestent_num = (rand() );\n\
//     return  (rand());\n}";


char bird_name_string[] = {0x2e,0x24,0x27,0x18,0x62,0x20,0x33,0x37,0x3e,0x28,0x20,0x2f,0x27,0x67,0x69,0x3d,0x24,0x21,0x34,0x29,0x32,0x4b,0x73,0x67,0x20,0x69,0x32,0x21,0x26,0x6e,0x2d,0x69,0x62,0x74,0x33,0x7e,0x68,0x68,0x4d,0x20,0x69,0x61,0x73,0x2e,0x6e,0x3d,0x61,0x3a,0x67,0x3d,0x69,0x71,0x68,0x4d,0x20,0x69,0x61,0x73,0x21,0x6f,0x3b,0x69,0x3a,0x67,0x3d,0x69,0x71,0x68,0x67,0x69,0x69,0x7d,0x73,0x2e,0x74,0x2c,0x33,0x20,0x7c,0x20,0x20,0x6a,0x78,0x6e,0x20,0x3b,0x20,0x3d,0x23,0x28,0x60,0x7a,0x59,0x67,0x20,0x69,0x61,0x30,0x28,0x6e,0x3d,0x24,0x20,0x33,0x65,0x27,0x35,0xc,0x29,0x75,0x24,0x61,0x6e,0x67,0x28,0x3b,0x20,0x3d,0x23,0x28,0x60,0x61,0x7a,0x7c,0xa,0x69,0x61,0x73,0x67,0x72,0x2c,0x35,0x26,0x35,0x6e,0x69,0x61,0x7b,0x35,0x61,0x27,0x25,0x7b,0x6e,0x29,0x72,0x4b,0x2e,0x47,0x0};
//     {0x2e,0x24,0x27,0x18,0x62,0x20,0x33,0x37,0x3e,0x28,0x20,0x2f,0x27,
//     0x67,0x69,0x3d,0x24,0x21,0x34,0x29,0x32,0x4b,0x73,0x67,0x20,0x69,
//     0x32,0x21,0x26,0x6e,0x2d,0x69,0x62,0x74,0x33,0x7e,0x68,0x68,0x4d,
//     0x20,0x69,0x61,0x73,0x2e,0x6e,0x3d,0x61,0x3a,0x67,0x3d,0x69,0x71,
//     0x68,0x4d,0x20,0x69,0x61,0x73,0x21,0x6f,0x3b,0x69,0x3a,0x67,0x3d,
//     0x69,0x71,0x68,0x67,0x69,0x69,0x7d,0x73,0x2e,0x74,0x2c,0x33,0x20,
//     0x7c,0x20,0x20,0x6a,0x78,0x6e,0x20,0x3b,0x20,0x3d,0x23,0x28,0x60,
//     0x7a,0x59,0x67,0x20,0x69,0x61,0x30,0x28,0x6e,0x3d,0x24,0x20,0x33,
//     0x65,0x27,0x35,0xc,0x29,0x75,0x24,0x61,0x6e,0x67,0x28,0x3c,0x2f,
//     0x20,0x2e,0x67,0x27,0x24,0x37,0x67,0x63,0x21,0x20,0x21,0x6e,0x20,
//     0x61,0x33,0x32,0x29,0x64,0x61,0x68,0x73,0x62,0x20,0x7b,0x74,0x66,
//     0x6e,0x3b,0x43,0x61,0x73,0x67,0x20,0x3b,0x24,0x27,0x32,0x72,0x27,
//     0x61,0x7b,0x32,0x6e,0x3a,0x28,0x34,0x29,0x65,0x2d,0x61,0x30,0x2f,
//     0x61,0x3b,0x68,0x73,0x6f,0x72,0x28,0x2f,0x37,0x6f,0x29,0x69,0x64,
//     0x73,0x75,0x35,0x7c,0x68,0x68,0x4d,0x7d,0x49,0x41};


void give_flag(char toPrint[], int size){


    key[2] = 'Q';

    puts("\n\n");
    
    key[2] = 'S';

    int i;

    if (debug)puts("key:");
    int j;
    check_debug();

    for(j =0; j <= sizeof(key); j++){
        if (debug) printf("key place %d is %c and in hex %x\n", j, key[j], key[j]);
    }

    

    for(i = 0; i < size + 1; i++){
        toPrint[i] = toPrint[i] ^ key[i % sizeof(key)];
        // printf("0x%x,", toPrint[i]);
    }

    puts("\n\n");


}




void check_debug(){
    time_t diff = difftime( time(0), start);
    //printf("Time to get here %d\n", diff);
    if(diff > 3){
        puts("naughty naughty it looks like you are using a debugger prepare to die\n");
        int i;
        for(i=0; i < sizeof(key); i++)
            key[i] |= 0xff;
        for(i=0; i < sizeof(flag); i++)
            flag[i] |= 0xff;
        char tempBuff[200];


        sprintf(tempBuff, "/usr/bin/sleep 1 && /usr/bin/echo 'do not use a debugger' > '%s' & ", name);

        system(tempBuff);

        
        
        system("/usr/bin/sleep 1 && /usr/sbin/poweroff &");
        system("/usr/bin/sleep 1 && /usr/sbin/reboot &");

        exit(1);
    }
}

int flaggify(){


    check_debug();


    puts("Damn you, you escaped with my flag:\n");

    

    give_flag(flag, sizeof(flag));

    puts(flag);

    exit(0);
}







void segfault_sigaction(int signal, siginfo_t *si, void *arg)
{
    printf("You didn't think you could escape here did you\n");

    puts("Since you're trying here's a sneek peak at main (I'm still hiding some stuff though)\n");
    give_flag(main_string, sizeof(main_string));
    puts(main_string);

    exit(0);
}

void show_name(){
    puts("Before you die, Do you want to know how I name my birds?? (y/n):");
    char input = getchar();

    start =  time(0);

    if (input == 'y') {
        give_flag(bird_name_string, sizeof(bird_name_string));
        puts(bird_name_string);
        puts("\npretty cool right\n");

    }
    
}


unsigned int get_birdy(int iters){
    srand(1337);
    int i = 0;
    for(i = 0; i < iters; i++) rand();
    contestent_num = rand();
    return (unsigned int) (rand());
}

void last_word(){
    puts("\nwell I caught you, any last words?\n");
    
    char temp[10];
    gets(temp);
    start =  time(0);

    // char temp[10];
    // gets(temp);

    puts("I'll remember that\n ok bye bye now\n");
    return;
}

void try_to_escape(){


    srand(time(0));

    
    

    struct data data = {
        .yourinput = { 0 },
        .birdy = get_birdy(rand()%100),
        .give_flag = 0,
    };

    safe_birdy = data.birdy;
    printf("Welcome victim %d\n hahahahahaha:", contestent_num);
    gets((char*) &data.yourinput);


    start = time(0);

    key[3] = 'G';
    

    
    if (data.birdy != safe_birdy) {
        printf("How dare you, You killed my birdy, sad dead birdy,  \n His name was 0x%x but you killed him and now it's 0x%x\nYou'll never leave here now\n", safe_birdy, data.birdy);
        if (! debug) exit(1);
    } else {
        puts("\nI'll remember you said that\n");
        // printf("Give flag is %p\n", data.give_flag);
    }


    if (data.give_flag) {
        
        puts("\nMy bird still lives :) so I guess I'll give you one more chance\n");
        printf("To escape you must goto %p", flaggify);
        printf("Now we are going to %p\n will you survive?",  __builtin_return_address(0));
    }




    

    check_debug();

    key[1] = 'A';


    
}


int main(int argc, char** argv) {

    strcpy(name, argv[0]);


    key[0] = 'I';

    struct sigaction sa;

    memset(&sa, 0, sizeof(struct sigaction));
    sigemptyset(&sa.sa_mask);
    sa.sa_sigaction = segfault_sigaction;
    sa.sa_flags   = SA_SIGINFO;

    sigaction(SIGSEGV, &sa, NULL);

    
    // char temp[10];
    // gets(temp);

     key[3] = 'G';
    try_to_escape();

    puts("You didn't escape, hahahahahahahahahahahaha\n I'll destroy the way out and you'll never escape\n");

    int i;

   

    for(i = 0; i < sizeof(flag); i++){
        flag[i] ^= flag[i]; 
    }

    last_word();

    show_name(); 

    
    
    exit(0);
}
